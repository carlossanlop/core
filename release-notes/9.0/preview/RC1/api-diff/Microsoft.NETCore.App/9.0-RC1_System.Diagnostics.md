# System.Diagnostics

``` diff
 namespace System.Diagnostics {
     public class Activity : IDisposable {
+        public Activity AddException(Exception exception, in TagList tags = default(TagList), DateTimeOffset timestamp = default(DateTimeOffset));
+        public Activity AddLink(ActivityLink link);
     }
     public sealed class ActivityListener : IDisposable {
+        public ExceptionRecorder ExceptionRecorder { get; set; }
     }
     public sealed class ActivitySource : IDisposable {
+        public ActivitySource(string name);
-        public ActivitySource(string name, string? version = "");
+        [EditorBrowsableAttribute(EditorBrowsableState.Never)]
+        public ActivitySource(string name, string? version = "");
+        public ActivitySource(string name, string? version = "", IEnumerable<KeyValuePair<string, object?>>? tags = null);
+        public IEnumerable<KeyValuePair<string, object?>>? Tags { get; }
-        public string Version { get; }
+        public string? Version { get; }
-        public Activity CreateActivity(string name, ActivityKind kind, ActivityContext parentContext, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink> links = null, ActivityIdFormat idFormat = ActivityIdFormat.Unknown);
+        public Activity? CreateActivity(string name, ActivityKind kind, ActivityContext parentContext, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink>? links = null, ActivityIdFormat idFormat = ActivityIdFormat.Unknown);
-        public Activity CreateActivity(string name, ActivityKind kind, string parentId, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink> links = null, ActivityIdFormat idFormat = ActivityIdFormat.Unknown);
+        public Activity? CreateActivity(string name, ActivityKind kind, string? parentId, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink>? links = null, ActivityIdFormat idFormat = ActivityIdFormat.Unknown);
-        public Activity StartActivity(ActivityKind kind, ActivityContext parentContext = default(ActivityContext), IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink> links = null, DateTimeOffset startTime = default(DateTimeOffset), [CallerMemberNameAttribute] string name = "");
+        public Activity? StartActivity(ActivityKind kind, ActivityContext parentContext = default(ActivityContext), IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink>? links = null, DateTimeOffset startTime = default(DateTimeOffset), [CallerMemberNameAttribute] string name = "");
-        public Activity StartActivity(string name, ActivityKind kind, ActivityContext parentContext, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink> links = null, DateTimeOffset startTime = default(DateTimeOffset));
+        public Activity? StartActivity(string name, ActivityKind kind, ActivityContext parentContext, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink>? links = null, DateTimeOffset startTime = default(DateTimeOffset));
-        public Activity StartActivity(string name, ActivityKind kind, string parentId, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink> links = null, DateTimeOffset startTime = default(DateTimeOffset));
+        public Activity? StartActivity(string name, ActivityKind kind, string? parentId, IEnumerable<KeyValuePair<string, object?>>? tags = null, IEnumerable<ActivityLink>? links = null, DateTimeOffset startTime = default(DateTimeOffset));
     }
     public static class Debug {
-        [ConditionalAttribute("DEBUG")]
-        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition);
+        [ConditionalAttribute("DEBUG")]
+        [OverloadResolutionPriorityAttribute(-1)]
+        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition);
-        [ConditionalAttribute("DEBUG")]
-        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition, string message);
+        [ConditionalAttribute("DEBUG")]
+        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition, [CallerArgumentExpressionAttribute("condition")] string message = null);
     }
     public static class Debugger {
+        public static void BreakForUserUnhandledException(Exception exception);
     }
+    [AttributeUsageAttribute(AttributeTargets.Method)]
+    public sealed class DebuggerDisableUserUnhandledExceptionsAttribute : Attribute {
+        public DebuggerDisableUserUnhandledExceptionsAttribute();
+    }
+    public sealed class DiagnosticMethodInfo {
+        public string DeclaringAssemblyName { get; }
+        public string DeclaringTypeName { get; }
+        public string Name { get; }
+        public static DiagnosticMethodInfo? Create(Delegate @delegate);
+        public static DiagnosticMethodInfo? Create(StackFrame frame);
+    }
+    public delegate void ExceptionRecorder(Activity activity, Exception exception, ref TagList tags);
     public class StackFrame {
-        [RequiresUnreferencedCodeAttribute("Metadata for the method might be incomplete or removed")]
-        public virtual MethodBase GetMethod();
+        [RequiresUnreferencedCodeAttribute("Metadata for the method might be incomplete or removed. Consider using DiagnosticMethodInfo.Create instead")]
+        public virtual MethodBase GetMethod();
     }
     public struct TagList : ICollection<KeyValuePair<string, object?>>, IEnumerable, IEnumerable<KeyValuePair<string, object?>>, IList<KeyValuePair<string, object?>>, IReadOnlyCollection<KeyValuePair<string, object?>>, IReadOnlyList<KeyValuePair<string, object?>> {
-        public TagList(ReadOnlySpan<KeyValuePair<string, object?>> tagList);
+        public TagList([ParamCollectionAttribute, ScopedRefAttribute] ReadOnlySpan<KeyValuePair<string, object?>> tagList);
     }
     public sealed class Trace {
-        [ConditionalAttribute("TRACE")]
-        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition);
+        [ConditionalAttribute("TRACE")]
+        [OverloadResolutionPriorityAttribute(-1)]
+        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition);
-        [ConditionalAttribute("TRACE")]
-        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition, string message);
+        [ConditionalAttribute("TRACE")]
+        public static void Assert([DoesNotReturnIfAttribute(false)] bool condition, [CallerArgumentExpressionAttribute("condition")] string message = null);
     }
 }
```

